Capstone Markdown
================
Corey Neff
6/29/2021

## Introduction

This project marks the culmination of about a semester’s worth (on &
off) of effort for my internship at the Addiciton Science Center at
ETSU. The project, tentatively titled *“Inter-professional Communication
to Prevent Prescription Drug Abuse in Appalachia”*, is intended to work
to understand mechanisms that lessen the impact of prescription
abuse/misuse in the Appalachian region. In short, the goal of this
project is to determine the extent to which patients communicate with
their Healthcare Providers (HCPs), including both physicians and
pharmacists, about issues surrounding prescription drug abuse.
Additionally, it will include some comparative analysis among the two
HCPs targeted. The work included here is largely visual/graphical in
nature, but will also include some humble models like ordinal logistic
regression, structural equation modeling, and perhaps even simple
machine learning models.

The data was collected from the geographic target of a 21-county area
spanning four states in Central Appalachia via phone, consisting of 60%
cell phone and 40% land-lines.

To begin with, we will load packages needed later and the data.

``` r
librarian::shelf(foreign, RColorBrewer, svglite, scales, ggpubr,
                 here, dplyr, ggplot2, plyr, stringr, tidyr,
                 lavaan, performance, kableExtra, semPlot)
data <- read.spss("/users/coreyneff/desktop/project2data/didarp.sav",
                  to.data.frame = TRUE,
                  use.value.labels = FALSE)
input <- data
input$Q4_RC[input$Q4_RC > 100] <- 100
input$Q9_RC <- input$Q9_RC %>% dplyr::na_if(-99)
input$Q53 <- input$Q53 %>% dplyr::na_if(99)
glimpse(data)
```

    ## Rows: 449
    ## Columns: 108
    ## $ UniqueID       <chr> "C17354", "C20546", "C19421", "C20670", "C20731", "C199…
    ## $ YOB            <dbl> 1988, 1952, 1999, 1991, 1971, 1969, 1968, 1977, 1949, 1…
    ## $ YOB2           <dbl> 997, 997, 997, 997, 997, 997, 997, 997, 997, 997, 997, …
    ## $ Zip            <dbl> 37643, 37857, 37818, 37659, 37660, 37620, 37643, 37620,…
    ## $ Q4_RC          <dbl> 15, 100, 30, 0, 10, 0, 0, 10, 0, 0, 0, 25, 90, 30, 1, 0…
    ## $ Q5_RC          <dbl> 50, 100, 10, 0, 5, 0, 0, 0, 0, 0, 0, 25, 0, 20, 0, 0, 3…
    ## $ Q6_RC          <dbl> 60, 0, 0, 0, 10, 0, 0, 10, 0, 0, NA, 25, 0, 0, 0, 0, 20…
    ## $ Q7_RC          <dbl> 25, 100, 10, 0, 50, 0, 0, 25, 0, 0, 0, 25, 0, 25, 0, 0,…
    ## $ Q8_RC          <dbl> 75, 100, 30, 0, 20, 0, 0, 0, 0, NA, 0, 25, 0, 50, 0, 0,…
    ## $ Q9_RC          <dbl> 5, 0, 0, 0, 25, 0, 0, 0, 0, NA, 0, 25, 0, 10, 0, 0, 0, …
    ## $ Q10            <dbl> 2, 5, 3, 1, 4, 1, 1, 5, 1, 2, 1, 2, 1, 3, 1, 1, 1, 5, 1…
    ## $ Q11            <dbl> 2, 5, 3, 1, 4, 2, 1, 1, 1, 1, 1, 2, 1, 3, 1, 1, 1, 1, 1…
    ## $ Q12            <dbl> 5, 5, 2, 1, 4, 1, 1, 3, 1, 1, 1, 2, 1, 2, 1, 1, 1, 1, 1…
    ## $ Q13            <dbl> 5, 5, 4, 1, 5, 1, 1, 5, 1, NA, 1, 2, 1, 2, 1, 1, 1, 5, …
    ## $ Q14            <dbl> 5, 5, 3, 1, 5, 2, 1, 1, 1, NA, 1, 2, 1, 3, 1, 1, 1, 1, …
    ## $ Q15            <dbl> 1, 5, 2, 1, 5, 1, 1, 3, 1, NA, 1, 2, 1, 2, 1, 1, 1, 1, …
    ## $ Q16            <dbl> 1, 1, 2, 1, 2, 1, 1, 1, 1, 1, 1, 1, 1, 1, 2, 1, 2, 2, 1…
    ## $ Q17_RC         <dbl> 25, 100, NA, 0, NA, 0, 0, 20, 0, NA, 0, 25, 5, 15, NA, …
    ## $ Q18_RC         <dbl> 10, 100, NA, 0, NA, 0, 0, 10, 0, NA, 5, 10, 0, 30, NA, …
    ## $ Q19_RC         <dbl> 80, 0, NA, 0, NA, 0, 0, 20, 0, NA, 0, 0, 0, 20, NA, 0, …
    ## $ Q20_RC         <dbl> 15, 100, NA, 0, NA, 0, 0, 20, 0, NA, 0, 25, 1, 10, NA, …
    ## $ Q21_RC         <dbl> 90, 100, NA, 0, NA, 0, 0, 10, 0, NA, 0, 10, 0, 10, NA, …
    ## $ Q22_RC         <dbl> 0, 0, NA, 0, NA, 0, 0, 10, 0, NA, 0, 0, 0, 20, NA, 0, N…
    ## $ Q23_RC         <dbl> 4, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, 5, 10, 10, 10…
    ## $ Q24_RC         <dbl> 3, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, 5, 10, 10, 10…
    ## $ Q25_RC         <dbl> 8, 10, 10, 10, 10, 10, 10, 10, 10, 10, 10, 5, 10, 10, 1…
    ## $ Q26_RC         <dbl> 9, 10, 10, 10, 10, 10, 10, 10, 10, 9, 10, 5, 10, 10, 10…
    ## $ Q27_RC         <dbl> 2, 6, 10, 10, 10, 10, 10, 10, 10, NA, 8, 5, 10, 10, 10,…
    ## $ Q28_RC         <dbl> 10, 6, 10, 10, 10, 10, 10, 10, 10, NA, 10, 5, 10, 10, 1…
    ## $ Q29_RC         <dbl> 6, 6, 10, 10, 10, 10, 10, 10, 10, NA, 8, 5, 10, 10, 10,…
    ## $ Q30_RC         <dbl> 5, 6, 10, 10, 10, 10, 0, 10, 10, NA, 8, 5, 10, 10, 10, …
    ## $ Q31_RC         <dbl> NA, 6, 4, 10, 0, NA, 10, 10, 10, 4, NA, 5, 10, 10, 10, …
    ## $ Q32            <dbl> 1, 1, 2, 1, 2, 1, 1, 1, 1, 3, 1, 3, 1, 1, 1, 1, 1, 1, 1…
    ## $ Q33            <dbl> 4, 4, 3, 3, 2, 4, 4, 4, 4, 2, 4, 4, 4, 4, 4, 4, 4, 4, 4…
    ## $ Q34            <dbl> 1, 1, 1, 1, 2, 1, 1, 1, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1…
    ## $ Q35            <dbl> 1, 1, 1, 1, 2, 1, 1, 1, 1, 4, 1, 1, 1, 1, 1, 1, 1, 1, 1…
    ## $ Q36            <dbl> 4, 4, 3, 4, 2, 4, 4, 4, 4, 1, 4, 4, 4, 4, 4, 4, 4, 4, 4…
    ## $ Q37            <dbl> 1, 2, 1, 2, 1, 1, 1, 1, 1, NA, 1, 1, 1, 1, 1, 1, 1, 1, …
    ## $ Q38            <dbl> 4, 2, 3, 4, 4, 4, 4, 4, 4, NA, 4, 4, 4, 4, 4, 4, 4, 4, …
    ## $ Q39            <dbl> 1, 2, 1, 1, 1, 1, 1, 1, 1, NA, 1, 1, 1, 1, 1, 1, 1, 4, …
    ## $ Q40            <dbl> 1, 2, 2, 1, 1, 1, 1, 1, 1, NA, 1, 1, 1, 1, 1, 1, 1, 4, …
    ## $ Q41            <dbl> 4, 2, 3, 4, 4, 4, 4, 4, 4, NA, 4, 4, 4, 4, 4, 4, 4, 4, …
    ## $ BreakOff1      <dbl> 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2…
    ## $ Q42            <dbl> 5, 5, 5, 5, 3, 5, 5, 5, 5, 4, 5, 5, 5, 5, 5, 5, 5, 4, 5…
    ## $ Q43            <dbl> 4, 5, 3, 5, 4, 5, 5, 5, 5, 2, 5, 5, 5, 5, 4, 5, 5, 5, 5…
    ## $ Q44            <dbl> 5, 5, 5, 5, 4, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5, 5…
    ## $ Q45            <dbl> 3, 1, 5, 1, 2, 1, 1, 5, 5, 3, 1, 5, 1, 5, 5, 5, 1, 1, 1…
    ## $ Q46            <dbl> 2, 1, 1, 5, 1, 1, 1, 1, 2, 1, 1, 5, 1, 2, 1, 1, 1, 1, 2…
    ## $ Q47            <dbl> 4, 1, 1, 1, 1, 1, 1, 3, 2, NA, 1, 5, 1, 4, 4, 5, 1, 1, …
    ## $ Q48            <dbl> 1, 1, 1, 2, 1, 1, 1, 3, 1, NA, 1, 5, 1, 2, 1, 1, 1, 1, …
    ## $ Q49            <dbl> 5, 1, NA, 4, 4, 4, 5, 4, 5, 2, 3, 4, 5, 4, 2, 2, 5, 3, …
    ## $ Q50            <dbl> 2, 1, NA, 4, 4, 4, 5, 4, 5, 2, 5, 4, 5, 2, 2, 2, 4, 2, …
    ## $ Q51            <dbl> 5, 1, NA, 4, 4, 4, 5, 4, 5, 2, 5, 4, 5, 2, 2, 2, 5, 4, …
    ## $ Q52            <dbl> 4, 1, NA, 4, 4, 4, 5, 4, 5, 4, 2, 4, 5, 2, 2, 2, 5, 2, …
    ## $ Q53            <dbl> 2, 1, NA, 4, 4, 4, 5, 4, 3, 2, 2, 4, 5, 2, 2, 2, 5, 2, …
    ## $ Q54            <dbl> 5, 1, NA, 4, 4, 4, 5, 4, 5, 4, 4, 4, 5, 2, 2, 2, 5, 4, …
    ## $ Q55            <dbl> 1, 1, NA, 2, 1, 1, 1, 1, 1, 1, 1, 2, 1, NA, 1, 1, 1, 1,…
    ## $ Q56            <dbl> 3, 4, NA, NA, 4, 4, 3, 4, 1, 4, 4, NA, 4, NA, 2, 4, 2, …
    ## $ Q57            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 4, 4, 5, 2, 5, NA, 5, 5, 5, 5…
    ## $ Q58            <dbl> 5, 5, NA, NA, 3, 5, 3, 5, 3, 1, 5, 2, 5, NA, 5, 5, 5, 5…
    ## $ Q59            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 3, 3, 5, 2, 5, NA, 5, 5, 5, 5…
    ## $ Q60            <dbl> 5, 5, NA, NA, 4, 5, 5, 5, 3, 3, 5, 2, 5, NA, 5, 5, 5, 5…
    ## $ Q61            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 5, 3, 5, 2, 5, NA, 5, 5, 5, 5…
    ## $ Q62            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 5, 3, 5, 2, 5, NA, 5, 5, 5, 5…
    ## $ Q63            <dbl> 5, 5, NA, NA, 4, 5, 5, 5, 5, 1, 5, 2, 5, NA, 5, 5, 5, 5…
    ## $ Q64            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 5, 1, 5, 2, 5, NA, 5, 5, 5, 5…
    ## $ Q65            <dbl> 5, 5, NA, NA, 3, 5, 3, 5, 3, 1, 5, 2, 5, NA, 3, 5, 5, 5…
    ## $ Q66            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 5, 2, 5, 2, 5, NA, 5, 5, 5, 5…
    ## $ Q67            <dbl> 5, 1, NA, NA, 5, 5, 1, 4, 3, 1, 5, 2, 1, NA, 4, 5, 5, 5…
    ## $ BreakOff2      <dbl> 2, 2, 1, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 1, 2, 2, 2, 2, 2…
    ## $ Q68            <dbl> 1, 1, NA, 2, 1, 1, 2, 2, 1, 2, 1, 2, 1, NA, 1, 1, 1, 2,…
    ## $ Q69            <dbl> 4, 4, NA, NA, 4, 4, NA, NA, 4, NA, 4, NA, 4, NA, 4, 4, …
    ## $ Q70            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 3, NA, 5, 2, 5, NA, 4, 5, 5, …
    ## $ Q71            <dbl> 2, 5, NA, NA, 5, 5, 1, 5, 3, NA, 5, 2, 5, NA, 5, 5, 5, …
    ## $ Q72            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 3, NA, 3, 2, 5, NA, 5, 5, 5, …
    ## $ Q73            <dbl> 5, 5, NA, 5, 5, 5, 3, 4, 3, NA, 3, 2, 5, NA, 5, 5, 5, 5…
    ## $ Q74            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 3, NA, 5, 2, 5, NA, 5, 5, 5, …
    ## $ Q75            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 3, NA, 5, 2, 5, NA, 5, 5, 5, …
    ## $ Q76            <dbl> 2, 5, NA, NA, 5, 5, 5, 5, 3, NA, 3, 2, 5, NA, 5, 5, 5, …
    ## $ Q77            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 3, NA, 5, 2, 5, NA, 5, 5, 5, …
    ## $ Q78            <dbl> 2, 5, NA, NA, 5, 5, 1, 5, 3, NA, 5, 2, 5, NA, 4, 5, 5, …
    ## $ Q79            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 3, NA, 5, 2, 5, NA, 4, 5, 5, …
    ## $ Q80            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 3, NA, 5, 2, 5, NA, 5, 5, 5, …
    ## $ Q82            <dbl> 5, 5, NA, 5, 4, 4, 5, 5, 4, 5, 5, 2, 5, NA, NA, 5, 5, 5…
    ## $ Q81            <dbl> 5, 5, NA, NA, 5, 5, 5, 5, 5, 5, 5, 2, 5, NA, 2, 5, 5, 5…
    ## $ Q83            <dbl> 5, 5, NA, 5, 5, 5, 5, 5, 3, 5, 5, 4, 5, NA, 5, 5, 5, 5,…
    ## $ Q84            <dbl> 5, 4, NA, 5, 5, 5, 5, 5, 4, 4, 5, 4, 5, NA, 3, 5, 5, 5,…
    ## $ Q85_RC         <dbl> 0, 0, NA, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, NA, 0, 0, 0, 0,…
    ## $ Q86            <dbl> 3, 1, NA, 1, 3, 1, 3, 1, 3, 2, 1, 3, 2, NA, 1, 2, 2, 1,…
    ## $ Q86b           <dbl> 2, NA, NA, NA, 1, NA, 1, NA, 2, NA, NA, NA, NA, NA, NA,…
    ## $ Q87            <dbl> 3, 1, NA, 1, 2, 2, 3, 2, 3, 3, 1, 3, 2, NA, 2, 4, 3, 3,…
    ## $ Q88            <dbl> 1, 1, NA, NA, 4, 1, 2, 1, 1, 1, 1, 2, 2, NA, 1, 1, 3, 1…
    ## $ Q89            <dbl> 1, 1, NA, 1, 1, 1, 2, 1, 1, 2, 2, 1, 2, NA, 2, 2, 2, 1,…
    ## $ Q90            <dbl> 2, 1, NA, NA, 1, 1, 1, 2, 2, 1, 2, 2, 2, NA, 2, 1, 1, 1…
    ## $ Q91            <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ Q92_RC         <dbl> 20000, NA, NA, NA, NA, NA, 50000, 60000, 42000, NA, 600…
    ## $ Q92b           <dbl> NA, 7, NA, NA, 4, 5, NA, NA, NA, NA, NA, 2, NA, NA, NA,…
    ## $ Q93            <dbl> 2, 2, NA, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, NA, 2, 2, 2, 2,…
    ## $ Q94            <dbl> 1, 1, NA, NA, 1, 1, 1, 1, 1, 7, 1, 1, 1, NA, 1, 1, 1, 1…
    ## $ Q94_Other_TEXT <chr> ".              ", ".              ", "               "…
    ## $ Q95            <dbl> 3, 4, NA, 3, 8, 8, 7, 7, 7, 7, 8, 3, 3, NA, 7, 7, 3, 7,…
    ## $ Land           <dbl> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA,…
    ## $ Cell           <dbl> 1, 1, NA, 1, NA, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1,…
    ## $ County         <chr> "Carter    ", "Hawkins   ", "Greene    ", "Washington",…
    ## $ CoQual         <chr> "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", "1", …
    ## $ BreakOff       <chr> " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", " ", …
    ## $ Partial        <dbl> NA, NA, 1, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, 1, N…
    ## $ Complete       <dbl> 1, 1, NA, 1, 1, 1, 1, 1, 1, 1, 1, 1, 1, NA, 1, 1, 1, 1,…

## Summary

There are a total of 108 variables, but we will not be using most of
them. The main outcome variables are questions 17-22. Questions 17-19
ask questions about communication with physicians, while 20-22 ask the
same questions about pharmacists. In order from question 17 to 19,
physician-related questions read:

In the past, when you have gotten a prescription for a pain pill or
another type of drug that could be abused, approximately what percentage
of the time have you…

17. Discussed the fact that the prescription medication could possibly
    be abused?

18. Discussed secure storage of prescription drugs with abuse potential?

19. Discussed a personal or family history of prescription or other drug
    abuse?

Again, these three physician-related questions are repeated in questions
20 to 22 for pharmacists instead. Because they are the same questions,
it may be beneficial to compare their responses visually. As such, three
graphics will follow: one for each pair of comparisons.

``` r
input %>% tidyr::pivot_longer(cols = c(Q17_RC, Q20_RC),
                                   names_to = "Q20",
                                   values_to = "Q20_scale") %>%
      dplyr::select(Q20, Q20_scale) %>%
      ggplot() +
      geom_density(aes(Q20_scale, fill = Q20), alpha = 0.65) +
      labs(fill = "Provider") +
      scale_fill_discrete(labels = c("Physician",
                                     "Pharmacist")) +
      xlab("Percentage") + 
      ylab("Density") +
      ggtitle(str_wrap("Approximately what percentage of the time have you discussed with your __ about the fact that the prescription medication could possibly be abused?", 60)) +
      theme(axis.text.x = element_text(angle = 0)) +
      theme_minimal()
```

![](Capstone_files/figure-gfm/q17-22-1.png)<!-- -->

``` r
input %>% tidyr::pivot_longer(cols = c(Q18_RC, Q21_RC),
                                   names_to = "Q21",
                                   values_to = "Q21_scale") %>%
      dplyr::select(Q21, Q21_scale) %>%
      ggplot() +
      geom_density(aes(Q21_scale, fill = Q21), alpha = 0.65) +
      labs(fill = "Provider") +
      scale_fill_discrete(labels = c("Physician",
                                     "Pharmacist")) +
      xlab("Percentage") + 
      ylab("Density") +
      ggtitle(str_wrap("Approximately what percentage of the time have you discussed with your __ about secure storage of prescription drugs with abuse potential?", 60)) +
      theme(axis.text.x = element_text(angle = 0)) +
      theme_minimal() 
```

![](Capstone_files/figure-gfm/q17-22-2.png)<!-- -->

``` r
input %>% tidyr::pivot_longer(cols = c(Q19_RC, Q22_RC),
                                   names_to = "Q22",
                                   values_to = "Q22_scale") %>%
      dplyr::select(Q22, Q22_scale) %>%
      ggplot() +
      geom_density(aes(Q22_scale, fill = Q22), alpha = 0.65) +
      labs(fill = "Provider") +
      scale_fill_discrete(labels = c("Physician",
                                     "Pharmacist")) +
      xlab("Percentage") + 
      ylab("Density") +
      ggtitle(str_wrap("Approximately what precentage of the time have you discussed with your __ about a personal or family history of prescription or other drug abuse?",60)) +
      theme(axis.text.x = element_text(angle = 0)) +
      theme_minimal()
```

![](Capstone_files/figure-gfm/q17-22-3.png)<!-- -->
